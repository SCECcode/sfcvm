#!/usr/bin/env python3

import pyproj
import numpy

CS_EPSG = "EPSG:2193"
CS_GEO = "EPSG:4326"

Y_AZIMUTH = 310.0 / 180.0 * numpy.pi 

# Model origin projected to EPSG:2193
ORIGIN_XY = (1591995.24, 5376443.77)

X_GRID = [0.0e+3, 464.0e+3, 514.0e+3, 561.0e+3, 600.0e+3, 633.0e+3, 663.0e+3, 693.0e+3, 723.0e+3, 752.0e+3, 782.0e+3, 812.0e+3, 842.0e+3, 887.0e+3, 931.0e+3, 976.0e+3, 1003.0e+3, 1013.0e+3, 1021.0e+3, 1029.0e+3, 1037.0e+3, 1045.0e+3, 1055.0e+3, 1070.0e+3, 1085.0e+3, 1100.0e+3, 1115.0e+3, 1130.0e+3, 1145.0e+3, 1160.0e+3, 1170.0e+3, 1180.0e+3, 1190.0e+3, 1200.0e+3, 1210.0e+3, 1220.0e+3, 1230.0e+3, 1240.0e+3, 1250.0e+3, 1260.0e+3, 1270.0e+3, 1280.0e+3, 1290.0e+3, 1305.0e+3, 1323.0e+3, 1348.0e+3, 1373.0e+3, 1398.0e+3, 1428.0e+3, 1453.0e+3, 1472.0e+3, 1491.0e+3, 1510.0e+3, 1529.0e+3, 1549.0e+3, 1579.0e+3, 1609.0e+3, 1639.0e+3, 1668.0e+3, 1694.0e+3, 1715.0e+3, 1736.0e+3, 1754.0e+3, 1773.0e+3, 1790.0e+3, 1810.0e+3, 1832.0e+3, 1853.0e+3, 1903.0e+3, 2400.0e+3]
Y_GRID = [0.0e+3, 850.0e+3, 900.0e+3, 940.0e+3, 970.0e+3, 995.0e+3, 1022.0e+3, 1039.0e+3, 1048.0e+3, 1055.0e+3, 1061.0e+3, 1067.0e+3, 1073.0e+3, 1079.0e+3, 1082.0e+3, 1086.0e+3, 1089.0e+3, 1093.0e+3, 1096.0e+3, 1100.0e+3, 1103.0e+3, 1107.0e+3, 1110.0e+3, 1114.0e+3, 1117.0e+3, 1121.0e+3, 1124.0e+3, 1128.0e+3, 1131.0e+3, 1135.0e+3, 1138.0e+3, 1142.0e+3, 1145.0e+3, 1149.0e+3, 1152.0e+3, 1156.0e+3, 1159.0e+3, 1163.0e+3, 1171.0e+3, 1178.0e+3, 1186.0e+3, 1193.0e+3, 1201.0e+3, 1208.0e+3, 1216.0e+3, 1223.0e+3, 1231.0e+3, 1238.0e+3, 1246.0e+3, 1253.0e+3, 1261.0e+3, 1268.0e+3, 1276.0e+3, 1286.0e+3, 1296.0e+3, 1306.0e+3, 1321.0e+3, 1336.0e+3, 1351.0e+3, 1400.0e+3, 1500.0e+3, 1600.0e+3, 1740.0e+3, 2400.0e+3]


x, y = numpy.meshgrid(X_GRID, Y_GRID, indexing="ij")
x = x.ravel() - 1200.0e+3
y = y.ravel() - 1200.0e+3

x_proj = +x*numpy.cos(Y_AZIMUTH) + y*numpy.sin(Y_AZIMUTH)
y_proj = -x*numpy.sin(Y_AZIMUTH) + y*numpy.cos(Y_AZIMUTH)

x_proj += ORIGIN_XY[0]
y_proj += ORIGIN_XY[1]

transformer = pyproj.Transformer.from_crs(crs_from=CS_EPSG, crs_to="EPSG:4326", always_xy=True)
y_geo, x_geo = transformer.transform(x_proj, y_proj)

import pdb; pdb.set_trace()

